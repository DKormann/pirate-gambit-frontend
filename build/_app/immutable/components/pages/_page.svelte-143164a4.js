import{S as W,i as C,s as F,k as w,q as U,a as B,l as T,m as j,r as H,h as a,c as V,n as J,b as E,F as g,H as R,I as G,A as q,J as ye,p as Ee,u as K,K as te,L as Q,e as ee,g as le,t as M,d as se,f as z,v as X,w as Z,x as $,y as x}from"../../chunks/index-549be724.js";import{u as A}from"../../chunks/utils-c14c6f14.js";function re(n){let t,s;return{c(){t=w("p"),s=U(n[1]),this.h()},l(e){t=T(e,"P",{style:!0});var l=j(t);s=H(l,n[1]),l.forEach(a),this.h()},h(){Ee(t,"color","red")},m(e,l){E(e,t,l),g(t,s)},p(e,l){l&2&&K(s,e[1])},d(e){e&&a(t)}}}function we(n){let t,s,e,l,r,o,c,i,_,p,P,h,k,u,N,m,S,I,b,f,d,y,O=n[1]&&re(n);return{c(){t=w("h1"),s=U("create account"),e=B(),l=w("h2"),r=U(`username
`),o=w("input"),c=B(),i=w("p"),_=U(`

password
`),p=w("input"),P=B(),h=w("p"),k=U(`

email
`),u=w("input"),N=B(),O&&O.c(),m=B(),S=w("p"),I=B(),b=w("button"),f=U("join"),this.h()},l(v){t=T(v,"H1",{});var D=j(t);s=H(D,"create account"),D.forEach(a),e=V(v),l=T(v,"H2",{});var L=j(l);r=H(L,`username
`),o=T(L,"INPUT",{type:!0}),c=V(L),i=T(L,"P",{}),j(i).forEach(a),_=H(L,`

password
`),p=T(L,"INPUT",{type:!0}),P=V(L),h=T(L,"P",{}),j(h).forEach(a),k=H(L,`

email
`),u=T(L,"INPUT",{}),N=V(L),O&&O.l(L),m=V(L),S=T(L,"P",{}),j(S).forEach(a),I=V(L),b=T(L,"BUTTON",{});var Y=j(b);f=H(Y,"join"),Y.forEach(a),L.forEach(a),this.h()},h(){J(o,"type","text"),J(p,"type","password")},m(v,D){E(v,t,D),g(t,s),E(v,e,D),E(v,l,D),g(l,r),g(l,o),R(o,n[0].name),g(l,c),g(l,i),g(l,_),g(l,p),R(p,n[0].password),g(l,P),g(l,h),g(l,k),g(l,u),R(u,n[0].email),g(l,N),O&&O.m(l,null),g(l,m),g(l,S),g(l,I),g(l,b),g(b,f),d||(y=[G(o,"input",n[4]),G(p,"input",n[5]),G(u,"input",n[6]),G(b,"click",n[2])],d=!0)},p(v,[D]){D&1&&o.value!==v[0].name&&R(o,v[0].name),D&1&&p.value!==v[0].password&&R(p,v[0].password),D&1&&u.value!==v[0].email&&R(u,v[0].email),v[1]?O?O.p(v,D):(O=re(v),O.c(),O.m(l,m)):O&&(O.d(1),O=null)},i:q,o:q,d(v){v&&a(t),v&&a(e),v&&a(l),O&&O.d(),d=!1,ye(y)}}}function Te(n,t,s){let{user:e}=t,{succ:l}=t,r="";function o(){if(e.name&&e.password){if(s(0,e.passhash=A.hash(e.password),e),e.email==""){s(1,r="email cant be empty");return}if(e.password==""){s(1,r="password cant be empty");return}if(e.name==""){s(1,r="username cant be empty");return}A.set_local("user_name",e.name),A.set_local("pass_hash",e.passhash),A.set_local("email",e.email),fetch(A.url+`register/${e.name}/${e.email}/${e.passhash}`,{method:"get"}).then(p=>{console.log(p),p.text().then(P=>{console.log({response:P});let h=JSON.parse(P);console.log(h),h[0]?(s(0,e.loggedIn=!0,e),l()):s(1,r=`${h.details}`)})})}else s(1,r="cant be empty")}function c(){e.name=this.value,s(0,e)}function i(){e.password=this.value,s(0,e)}function _(){e.email=this.value,s(0,e)}return n.$$set=p=>{"user"in p&&s(0,e=p.user),"succ"in p&&s(3,l=p.succ)},[e,r,o,l,c,i,_]}class Pe extends W{constructor(t){super(),C(this,t,Te,we,F,{user:0,succ:3})}}function ie(n,t,s){const e=n.slice();return e[19]=t[s],e[21]=s,e}function ae(n,t,s){const e=n.slice();return e[19]=t[s],e[23]=s,e}function ue(n,t,s){const e=n.slice();return e[19]=t[s],e[25]=s,e}function Ne(n){let t,s=n[1].reduce(n[12])[0]+"",e,l,r,o;return{c(){t=w("h2"),e=U(s),l=U(" found the treasure! get his King to win"),r=B(),o=w("p")},l(c){t=T(c,"H2",{});var i=j(t);e=H(i,s),l=H(i," found the treasure! get his King to win"),i.forEach(a),r=V(c),o=T(c,"P",{}),j(o).forEach(a)},m(c,i){E(c,t,i),g(t,e),g(t,l),E(c,r,i),E(c,o,i)},p(c,i){i&3&&s!==(s=c[1].reduce(c[12])[0]+"")&&K(e,s)},d(c){c&&a(t),c&&a(r),c&&a(o)}}}function je(n){let t,s;return{c(){t=w("h2"),s=U("get the treasure at the center!")},l(e){t=T(e,"H2",{});var l=j(t);s=H(l,"get the treasure at the center!"),l.forEach(a)},m(e,l){E(e,t,l),g(t,s)},p:q,d(e){e&&a(t)}}}function Ie(n){let t,s,e,l,r,o,c;return{c(){t=w("h2"),s=U("you got the treasure"),e=B(),l=w("h2"),r=U("go to the green zone to win!"),o=B(),c=w("p")},l(i){t=T(i,"H2",{});var _=j(t);s=H(_,"you got the treasure"),_.forEach(a),e=V(i),l=T(i,"H2",{});var p=j(l);r=H(p,"go to the green zone to win!"),p.forEach(a),o=V(i),c=T(i,"P",{}),j(c).forEach(a)},m(i,_){E(i,t,_),g(t,s),E(i,e,_),E(i,l,_),g(l,r),E(i,o,_),E(i,c,_)},p:q,d(i){i&&a(t),i&&a(e),i&&a(l),i&&a(o),i&&a(c)}}}function fe(n){let t,s,e,l=n[8](n[0].data[n[23]+n[25]*9])+"",r,o,c,i,_;function p(){return n[13](n[23],n[25])}return{c(){t=w("div"),s=w("div"),e=w("p"),r=U(l),this.h()},l(P){t=T(P,"DIV",{class:!0,id:!0});var h=j(t);s=T(h,"DIV",{class:!0});var k=j(s);e=T(k,"P",{class:!0});var u=j(e);r=H(u,l),u.forEach(a),k.forEach(a),h.forEach(a),this.h()},h(){J(e,"class","pinfo svelte-kyprf3"),J(s,"class",o=Q(n[6](n[0].data[n[23]+n[25]*9]))+" svelte-kyprf3"),J(t,"class",c=Q((n[23]==n[2][0]&&n[25]==n[2][1]?"active ":"")+de(n[0].data[n[23]+n[25]*9],n[0].offset[0]+n[0].offset[1]+n[23]+n[25]))+" svelte-kyprf3"),J(t,"id","t"+n[23]+n[25])},m(P,h){E(P,t,h),g(t,s),g(s,e),g(e,r),i||(_=G(t,"click",p),i=!0)},p(P,h){n=P,h&1&&l!==(l=n[8](n[0].data[n[23]+n[25]*9])+"")&&K(r,l),h&1&&o!==(o=Q(n[6](n[0].data[n[23]+n[25]*9]))+" svelte-kyprf3")&&J(s,"class",o),h&5&&c!==(c=Q((n[23]==n[2][0]&&n[25]==n[2][1]?"active ":"")+de(n[0].data[n[23]+n[25]*9],n[0].offset[0]+n[0].offset[1]+n[23]+n[25]))+" svelte-kyprf3")&&J(t,"class",c)},d(P){P&&a(t),i=!1,_()}}}function ce(n){let t,s={length:9},e=[];for(let l=0;l<s.length;l+=1)e[l]=fe(ue(n,s,l));return{c(){t=w("div");for(let l=0;l<e.length;l+=1)e[l].c();this.h()},l(l){t=T(l,"DIV",{class:!0});var r=j(t);for(let o=0;o<e.length;o+=1)e[o].l(r);r.forEach(a),this.h()},h(){J(t,"class","row svelte-kyprf3")},m(l,r){E(l,t,r);for(let o=0;o<e.length;o+=1)e[o].m(t,null)},p(l,r){if(r&357){s={length:9};let o;for(o=0;o<s.length;o+=1){const c=ue(l,s,o);e[o]?e[o].p(c,r):(e[o]=fe(c),e[o].c(),e[o].m(t,null))}for(;o<e.length;o+=1)e[o].d(1);e.length=s.length}},d(l){l&&a(t),te(e,l)}}}function Oe(n){let t,s;return{c(){t=w("div"),s=U("no"),this.h()},l(e){t=T(e,"DIV",{class:!0});var l=j(t);s=H(l,"no"),l.forEach(a),this.h()},h(){J(t,"class","tile svelte-kyprf3")},m(e,l){E(e,t,l),g(t,s)},p:q,d(e){e&&a(t)}}}function Se(n){let t,s={length:5},e=[];for(let l=0;l<s.length;l+=1)e[l]=he(ie(n,s,l));return{c(){t=w("div");for(let l=0;l<e.length;l+=1)e[l].c();this.h()},l(l){t=T(l,"DIV",{class:!0});var r=j(t);for(let o=0;o<e.length;o+=1)e[o].l(r);r.forEach(a),this.h()},h(){J(t,"class","row svelte-kyprf3")},m(l,r){E(l,t,r);for(let o=0;o<e.length;o+=1)e[o].m(t,null)},p(l,r){if(r&145){s={length:5};let o;for(o=0;o<s.length;o+=1){const c=ie(l,s,o);e[o]?e[o].p(c,r):(e[o]=he(c),e[o].c(),e[o].m(t,null))}for(;o<e.length;o+=1)e[o].d(1);e.length=s.length}},d(l){l&&a(t),te(e,l)}}}function _e(n){let t,s,e,l,r;function o(){return n[14](n[21])}return{c(){t=w("div"),s=w("div"),e=B(),this.h()},l(c){t=T(c,"DIV",{class:!0});var i=j(t);s=T(i,"DIV",{class:!0});var _=j(s);_.forEach(a),e=V(i),i.forEach(a),this.h()},h(){J(s,"class",Q(`piece t${n[21]+2}`)+" svelte-kyprf3"),J(t,"class","tile svelte-kyprf3")},m(c,i){E(c,t,i),g(t,s),g(t,e),l||(r=G(t,"click",o),l=!0)},p(c,i){n=c},d(c){c&&a(t),l=!1,r()}}}function he(n){let t,s=n[4][n[21]]<=n[0].energy&&_e(n);return{c(){s&&s.c(),t=ee()},l(e){s&&s.l(e),t=ee()},m(e,l){s&&s.m(e,l),E(e,t,l)},p(e,l){e[4][e[21]]<=e[0].energy?s?s.p(e,l):(s=_e(e),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},d(e){s&&s.d(e),e&&a(t)}}}function Ue(n){let t,s,e,l,r,o,c,i,_=Math.round(n[0].energy*50)/50+"",p,P;function h(f,d){return f[0].got_treasure?Ie:f[0].treasure_holder==-1?je:Ne}let k=h(n),u=k(n),N={length:9},m=[];for(let f=0;f<N.length;f+=1)m[f]=ce(ae(n,N,f));function S(f,d){return f[3]?Se:Oe}let I=S(n),b=I(n);return{c(){t=w("div"),u.c(),s=B();for(let f=0;f<m.length;f+=1)m[f].c();e=B(),l=w("p"),r=B(),b.c(),o=B(),c=w("div"),i=w("p"),p=U(_),this.h()},l(f){t=T(f,"DIV",{class:!0});var d=j(t);u.l(d),s=V(d);for(let v=0;v<m.length;v+=1)m[v].l(d);e=V(d),l=T(d,"P",{}),j(l).forEach(a),r=V(d),b.l(d),o=V(d),c=T(d,"DIV",{class:!0,style:!0});var y=j(c);i=T(y,"P",{class:!0});var O=j(i);p=H(O,_),O.forEach(a),y.forEach(a),d.forEach(a),this.h()},h(){J(i,"class","svelte-kyprf3"),J(c,"class","energybar svelte-kyprf3"),J(c,"style",P=`width:${n[0].energy*2.7}em`),J(t,"class","board svelte-kyprf3")},m(f,d){E(f,t,d),u.m(t,null),g(t,s);for(let y=0;y<m.length;y+=1)m[y].m(t,null);g(t,e),g(t,l),g(t,r),b.m(t,null),g(t,o),g(t,c),g(c,i),g(i,p)},p(f,[d]){if(k===(k=h(f))&&u?u.p(f,d):(u.d(1),u=k(f),u&&(u.c(),u.m(t,s))),d&357){N={length:9};let y;for(y=0;y<N.length;y+=1){const O=ae(f,N,y);m[y]?m[y].p(O,d):(m[y]=ce(O),m[y].c(),m[y].m(t,e))}for(;y<m.length;y+=1)m[y].d(1);m.length=N.length}I===(I=S(f))&&b?b.p(f,d):(b.d(1),b=I(f),b&&(b.c(),b.m(t,o))),d&1&&_!==(_=Math.round(f[0].energy*50)/50+"")&&K(p,_),d&1&&P!==(P=`width:${f[0].energy*2.7}em`)&&J(c,"style",P)},i:q,o:q,d(f){f&&a(t),u.d(),te(m,f),b.d()}}}let pe=20,He=.2;function me(n,t){return n+t*9}function de(n,t){if(n==null)return"water tile";if(n.status.Taken)return"tile c"+n.status.Taken[0];let s="";return n.ground=="Safe"&&(s=" safe"),n.ground=="Treasure"&&(s=" treasure"),["light","dark"][t%2]+s+" tile"}function Je(n,t,s){let{state:e}=t,{my_number:l}=t,{make_move:r}=t,{opponents:o}=t;e.data;let c=[4,4];const i=[9,3,3,5,1];let _=[-5,-5],p=!1,P=1;setInterval(()=>{e.energy<=10&&s(0,e.energy=Math.min(e.energy+He/pe,10),e)},1e3/pe);function h(f,d){let y=e.data[f+d*9];y&&y.status&&y.status.Taken&&y.status.Taken[1]=="King"&&y.status.Taken[0]==l?s(3,p=!0):(console.log(y),s(3,p=!1));{let O=me(_[0],_[1]),v=me(f,d);if(v==O)return;r(O,v,P,D=>{D&&(P=0)})}k(f,d)}function k(f,d){let y=document.querySelector("#t"+_[0]+_[1]);y&&y.classList.remove("active"),s(2,_=[f,d]),document.querySelector("#t"+f+d).classList.add("active")}function u(f){if(f==null||f.status=="Empty")return"";if(f.status.Taken){let d=f.status.Taken,y=d[0],O=d[1],v=y==l;return O=="King"&&v&&P>1?"piece t"+P:"piece "+O+(v?"":" enemy")}return"piece error"}function N(f){P=f+2}function m(f){if(f&&f.status&&f.status.Taken&&f.status.Taken[1]=="King"){let d=f.status.Taken[0],y=o.reduce((O,v)=>O[1]==d?O:v)[0];return y=y.split(" ")[0],y.slice(0,8)}return""}const S=(f,d)=>f[1]==e.treasure_holder?f:d,I=(f,d)=>h(f,d),b=f=>{N(f)};return n.$$set=f=>{"state"in f&&s(0,e=f.state),"my_number"in f&&s(9,l=f.my_number),"make_move"in f&&s(10,r=f.make_move),"opponents"in f&&s(1,o=f.opponents)},n.$$.update=()=>{n.$$.dirty&2053&&e.offset!=c&&(s(2,_=[_[0]+c[1]-e.offset[1],_[1]+c[0]-e.offset[0]]),s(11,c=e.offset))},[e,o,_,p,i,h,u,N,m,l,r,c,S,I,b]}class Be extends W{constructor(t){super(),C(this,t,Je,Ue,F,{state:0,my_number:9,make_move:10,opponents:1})}}function be(n,t,s){const e=n.slice();return e[18]=t[s][0],e[19]=t[s][1],e}function Ve(n){let t,s,e,l,r,o,c=n[7].Leave.value+"",i,_,p,P,h,k,u,N,m,S;return{c(){t=w("h3"),s=U("you left"),e=B(),l=w("h3"),r=U("score: "),o=w("span"),i=U(c),_=B(),p=w("button"),P=U("Play again"),h=B(),k=w("a"),u=w("button"),N=U("leaderboard"),this.h()},l(I){t=T(I,"H3",{});var b=j(t);s=H(b,"you left"),b.forEach(a),e=V(I),l=T(I,"H3",{});var f=j(l);r=H(f,"score: "),o=T(f,"SPAN",{class:!0});var d=j(o);i=H(d,c),d.forEach(a),f.forEach(a),_=V(I),p=T(I,"BUTTON",{id:!0});var y=j(p);P=H(y,"Play again"),y.forEach(a),h=V(I),k=T(I,"A",{href:!0});var O=j(k);u=T(O,"BUTTON",{class:!0});var v=j(u);N=H(v,"leaderboard"),v.forEach(a),O.forEach(a),this.h()},h(){J(o,"class","gold svelte-jcaibo"),J(p,"id","joingame"),J(u,"class","leaderboard svelte-jcaibo"),J(k,"href","/leaderboard")},m(I,b){E(I,t,b),g(t,s),E(I,e,b),E(I,l,b),g(l,r),g(l,o),g(o,i),E(I,_,b),E(I,p,b),g(p,P),E(I,h,b),E(I,k,b),g(k,u),g(u,N),m||(S=G(p,"click",n[8]),m=!0)},p(I,b){b&128&&c!==(c=I[7].Leave.value+"")&&K(i,c)},i:q,o:q,d(I){I&&a(t),I&&a(e),I&&a(l),I&&a(_),I&&a(p),I&&a(h),I&&a(k),m=!1,S()}}}function De(n){let t,s,e,l,r=n[6][0]+"",o,c,i=n[5].value+"",_,p,P,h,k,u,N,m,S,I,b,f,d,y,O;return{c(){t=w("h2"),s=U("GAME OVER"),e=B(),l=w("h3"),o=U(r),c=U(" won "),_=U(i),p=U(" points!"),P=B(),h=w("p"),k=B(),u=w("button"),N=U("Play again"),m=B(),S=w("p"),I=B(),b=w("a"),f=w("button"),d=U("leaderboard"),this.h()},l(v){t=T(v,"H2",{});var D=j(t);s=H(D,"GAME OVER"),D.forEach(a),e=V(v),l=T(v,"H3",{});var L=j(l);o=H(L,r),c=H(L," won "),_=H(L,i),p=H(L," points!"),L.forEach(a),P=V(v),h=T(v,"P",{}),j(h).forEach(a),k=V(v),u=T(v,"BUTTON",{class:!0});var Y=j(u);N=H(Y,"Play again"),Y.forEach(a),m=V(v),S=T(v,"P",{}),j(S).forEach(a),I=V(v),b=T(v,"A",{href:!0});var ne=j(b);f=T(ne,"BUTTON",{class:!0});var oe=j(f);d=H(oe,"leaderboard"),oe.forEach(a),ne.forEach(a),this.h()},h(){J(u,"class","joingame svelte-jcaibo"),J(f,"class","leaderboard svelte-jcaibo"),J(b,"href","/leaderboard")},m(v,D){E(v,t,D),g(t,s),E(v,e,D),E(v,l,D),g(l,o),g(l,c),g(l,_),g(l,p),E(v,P,D),E(v,h,D),E(v,k,D),E(v,u,D),g(u,N),E(v,m,D),E(v,S,D),E(v,I,D),E(v,b,D),g(b,f),g(f,d),y||(O=G(u,"click",n[8]),y=!0)},p(v,D){D&64&&r!==(r=v[6][0]+"")&&K(o,r),D&32&&i!==(i=v[5].value+"")&&K(_,i)},i:q,o:q,d(v){v&&a(t),v&&a(e),v&&a(l),v&&a(P),v&&a(h),v&&a(k),v&&a(u),v&&a(m),v&&a(S),v&&a(I),v&&a(b),y=!1,O()}}}function Le(n){let t,s,e,l,r,o,c;return l=new Be({props:{state:n[4],my_number:n[2],make_move:n[10],opponents:n[3]}}),{c(){t=w("button"),s=U("leave game"),e=B(),X(l.$$.fragment),this.h()},l(i){t=T(i,"BUTTON",{class:!0});var _=j(t);s=H(_,"leave game"),_.forEach(a),e=V(i),Z(l.$$.fragment,i),this.h()},h(){J(t,"class","surrender svelte-jcaibo")},m(i,_){E(i,t,_),g(t,s),E(i,e,_),$(l,i,_),r=!0,o||(c=G(t,"click",n[12]),o=!0)},p(i,_){const p={};_&16&&(p.state=i[4]),_&4&&(p.my_number=i[2]),_&8&&(p.opponents=i[3]),l.$set(p)},i(i){r||(z(l.$$.fragment,i),r=!0)},o(i){M(l.$$.fragment,i),r=!1},d(i){i&&a(t),i&&a(e),x(l,i),o=!1,c()}}}function qe(n){let t,s,e,l,r,o,c,i,_,p,P=n[3],h=[];for(let u=0;u<P.length;u+=1)h[u]=ge(be(n,P,u));let k=n[3].length>1&&ve(n);return{c(){t=w("h2"),s=U("waiting for players ..."),e=B();for(let u=0;u<h.length;u+=1)h[u].c();l=B(),r=w("button"),o=U("leave"),c=B(),k&&k.c(),i=ee(),this.h()},l(u){t=T(u,"H2",{});var N=j(t);s=H(N,"waiting for players ..."),N.forEach(a),e=V(u);for(let S=0;S<h.length;S+=1)h[S].l(u);l=V(u),r=T(u,"BUTTON",{class:!0});var m=j(r);o=H(m,"leave"),m.forEach(a),c=V(u),k&&k.l(u),i=ee(),this.h()},h(){J(r,"class","leaderboard svelte-jcaibo")},m(u,N){E(u,t,N),g(t,s),E(u,e,N);for(let m=0;m<h.length;m+=1)h[m].m(u,N);E(u,l,N),E(u,r,N),g(r,o),E(u,c,N),k&&k.m(u,N),E(u,i,N),_||(p=G(r,"click",n[11]),_=!0)},p(u,N){if(N&8){P=u[3];let m;for(m=0;m<P.length;m+=1){const S=be(u,P,m);h[m]?h[m].p(S,N):(h[m]=ge(S),h[m].c(),h[m].m(l.parentNode,l))}for(;m<h.length;m+=1)h[m].d(1);h.length=P.length}u[3].length>1?k?k.p(u,N):(k=ve(u),k.c(),k.m(i.parentNode,i)):k&&(k.d(1),k=null)},i:q,o:q,d(u){u&&a(t),u&&a(e),te(h,u),u&&a(l),u&&a(r),u&&a(c),k&&k.d(u),u&&a(i),_=!1,p()}}}function Ae(n){let t,s,e,l,r,o,c,i,_,p,P,h,k,u,N;return{c(){t=w("div"),s=B(),e=w("h2"),l=U("Welcome to Tarcarot"),r=B(),o=w("button"),c=U("Join game"),i=B(),_=w("p"),p=B(),P=w("a"),h=w("button"),k=U("leaderboard"),this.h()},l(m){t=T(m,"DIV",{class:!0}),j(t).forEach(a),s=V(m),e=T(m,"H2",{class:!0});var S=j(e);l=H(S,"Welcome to Tarcarot"),S.forEach(a),r=V(m),o=T(m,"BUTTON",{class:!0});var I=j(o);c=H(I,"Join game"),I.forEach(a),i=V(m),_=T(m,"P",{}),j(_).forEach(a),p=V(m),P=T(m,"A",{href:!0});var b=j(P);h=T(b,"BUTTON",{class:!0});var f=j(h);k=H(f,"leaderboard"),f.forEach(a),b.forEach(a),this.h()},h(){J(t,"class","logo svelte-jcaibo"),J(e,"class","gold svelte-jcaibo"),J(o,"class","joingame svelte-jcaibo"),J(h,"class","leaderboard svelte-jcaibo"),J(P,"href","/leaderboard")},m(m,S){E(m,t,S),E(m,s,S),E(m,e,S),g(e,l),E(m,r,S),E(m,o,S),g(o,c),E(m,i,S),E(m,_,S),E(m,p,S),E(m,P,S),g(P,h),g(h,k),u||(N=G(o,"click",n[8]),u=!0)},p:q,i:q,o:q,d(m){m&&a(t),m&&a(s),m&&a(e),m&&a(r),m&&a(o),m&&a(i),m&&a(_),m&&a(p),m&&a(P),u=!1,N()}}}function ge(n){let t,s=n[18]+"",e;return{c(){t=w("p"),e=U(s)},l(l){t=T(l,"P",{});var r=j(t);e=H(r,s),r.forEach(a)},m(l,r){E(l,t,r),g(t,e)},p(l,r){r&8&&s!==(s=l[18]+"")&&K(e,s)},d(l){l&&a(t)}}}function ve(n){let t,s,e,l;return{c(){t=w("button"),s=U("Start"),this.h()},l(r){t=T(r,"BUTTON",{class:!0});var o=j(t);s=H(o,"Start"),o.forEach(a),this.h()},h(){J(t,"class","startgame svelte-jcaibo")},m(r,o){E(r,t,o),g(t,s),e||(l=G(t,"click",n[9]),e=!0)},p:q,d(r){r&&a(t),e=!1,l()}}}function Ge(n){let t,s,e=n[0].name+"",l,r,o,c,i;const _=[Ae,qe,Le,De,Ve],p=[];function P(h,k){return h[1]==0?0:h[1]==1?1:h[1]==2?2:h[1]==3?3:h[1]==4?4:-1}return~(o=P(n))&&(c=p[o]=_[o](n)),{c(){t=w("h2"),s=w("p"),l=U(e),r=B(),c&&c.c(),this.h()},l(h){t=T(h,"H2",{});var k=j(t);s=T(k,"P",{class:!0});var u=j(s);l=H(u,e),u.forEach(a),r=V(k),c&&c.l(k),k.forEach(a),this.h()},h(){J(s,"class","usertag svelte-jcaibo")},m(h,k){E(h,t,k),g(t,s),g(s,l),g(t,r),~o&&p[o].m(t,null),i=!0},p(h,[k]){(!i||k&1)&&e!==(e=h[0].name+"")&&K(l,e);let u=o;o=P(h),o===u?~o&&p[o].p(h,k):(c&&(le(),M(p[u],1,1,()=>{p[u]=null}),se()),~o?(c=p[o],c?c.p(h,k):(c=p[o]=_[o](h),c.c()),z(c,1),c.m(t,null)):c=null)},i(h){i||(z(c),i=!0)},o(h){M(c),i=!1},d(h){h&&a(t),~o&&p[o].d()}}}function Ke(n,t,s){let{user:e}=t,l=0,r=0,o=0,c=0,i=[],_=null,p=null,P=null,h=null;function k(){fetch(A.url+`join_game/${e.name}/${e.passhash}`).then(b=>{console.log(b),b.text().then(f=>{console.log({text:f});let d=JSON.parse(f);console.log({data:d}),d.Join?(s(1,l=1),console.log("got join message"),r=d.Join.token,o=d.Join.game_id,s(2,c=d.Join.number),u()):d.Lobby?console.log("got lobby message"):d.State&&console.log("got state message")})})}function u(){console.log("sending update request"),fetch(A.url+`get_update/${o}/${r}`).then(b=>{console.log(b),b.text().then(f=>{console.log({text:f});let d=JSON.parse(f);if(console.log({data:d}),d.Join)console.log("got join message");else if(d.Lobby)console.log("got lobby message"),s(3,i=d.Lobby.players);else if(d.State)console.log("got state message"),s(4,_=d.State),s(1,l=2);else if(d.End){s(1,l=3),console.log("got game over message"),s(5,p=d.End),console.log(p),s(6,P=i.reduce((y,O)=>y[1]==p.winning_number?y:O));return}else if(d=="Leave"){console.log("got leave message"),alert("you disconnected from the game"),s(1,l=0);return}u()})})}function N(){console.log("sending start request"),fetch(A.url+`start_game/${o}/${r}`).then(b=>{console.log(b),b.text().then(f=>{console.log(f)})})}function m(b,f,d,y){console.log("sending move"),fetch(A.url+`make_move/${o}/${r}/${b}/${f}/${d}`,{method:"post"}).then(O=>{O.text().then(v=>{console.log(v);let D=JSON.parse(v);y(D)})})}function S(){console.log("leaving lobby"),fetch(A.url+`leave_lobby/${o}/${r}`).then(b=>{console.log(b),b.text().then(f=>{console.log(f)})}),s(1,l=0)}function I(){console.log("game leave request"),fetch(A.url+`leave_game/${o}/${r}`).then(b=>{console.log(b),b.text().then(f=>{console.log(f);let d=JSON.parse(f);if(d.End){s(1,l=3),console.log("got game over message"),s(5,p=d.End),console.log(p),s(6,P=i.reduce((y,O)=>y[1]==p.winning_number?y:O)),s(1,l=3);return}else s(7,h=d),s(1,l=4)})})}return n.$$set=b=>{"user"in b&&s(0,e=b.user)},[e,l,c,i,_,p,P,h,k,N,m,S,I]}class Me extends W{constructor(t){super(),C(this,t,Ke,Ge,F,{user:0})}}function ke(n){let t,s;return{c(){t=w("p"),s=U(n[1]),this.h()},l(e){t=T(e,"P",{style:!0});var l=j(t);s=H(l,n[1]),l.forEach(a),this.h()},h(){Ee(t,"color","red")},m(e,l){E(e,t,l),g(t,s)},p(e,l){l&2&&K(s,e[1])},d(e){e&&a(t)}}}function ze(n){let t,s,e,l,r,o,c,i,_,p,P,h,k,u,N,m,S,I,b=n[1]&&ke(n);return{c(){t=w("h1"),s=U("login"),e=B(),l=w("h2"),r=U(`username
`),o=w("input"),c=B(),i=w("p"),_=U(`

password
`),p=w("input"),P=B(),b&&b.c(),h=B(),k=w("p"),u=B(),N=w("button"),m=U("login"),this.h()},l(f){t=T(f,"H1",{});var d=j(t);s=H(d,"login"),d.forEach(a),e=V(f),l=T(f,"H2",{});var y=j(l);r=H(y,`username
`),o=T(y,"INPUT",{type:!0}),c=V(y),i=T(y,"P",{}),j(i).forEach(a),_=H(y,`

password
`),p=T(y,"INPUT",{type:!0}),P=V(y),b&&b.l(y),h=V(y),k=T(y,"P",{}),j(k).forEach(a),u=V(y),N=T(y,"BUTTON",{});var O=j(N);m=H(O,"login"),O.forEach(a),y.forEach(a),this.h()},h(){J(o,"type","text"),J(p,"type","password")},m(f,d){E(f,t,d),g(t,s),E(f,e,d),E(f,l,d),g(l,r),g(l,o),R(o,n[0].name),g(l,c),g(l,i),g(l,_),g(l,p),R(p,n[0].password),g(l,P),b&&b.m(l,null),g(l,h),g(l,k),g(l,u),g(l,N),g(N,m),S||(I=[G(o,"input",n[4]),G(p,"input",n[5]),G(N,"click",n[2])],S=!0)},p(f,[d]){d&1&&o.value!==f[0].name&&R(o,f[0].name),d&1&&p.value!==f[0].password&&R(p,f[0].password),f[1]?b?b.p(f,d):(b=ke(f),b.c(),b.m(l,h)):b&&(b.d(1),b=null)},i:q,o:q,d(f){f&&a(t),f&&a(e),f&&a(l),b&&b.d(),S=!1,ye(I)}}}function Re(n,t,s){let{user:e}=t,{succ:l}=t,r="";function o(){if(s(0,e.passhash=A.hash(e.password),e),e.password==""){s(1,r="password cant be empty");return}if(e.name==""){s(1,r="username cant be empty");return}A.set_local("user_name",e.name),A.set_local("pass_hash",e.passhash),fetch(A.url+`login/${e.name}/${e.passhash}`,{method:"get"}).then(_=>{console.log(_),console.log({res:_}),_.text().then(p=>{console.log({response:p}),p=="true"?l():s(1,r="password or username incorrect")})})}function c(){e.name=this.value,s(0,e)}function i(){e.password=this.value,s(0,e)}return n.$$set=_=>{"user"in _&&s(0,e=_.user),"succ"in _&&s(3,l=_.succ)},[e,r,o,l,c,i]}class We extends W{constructor(t){super(),C(this,t,Re,ze,F,{user:0,succ:3})}}function Ce(n){let t,s,e,l,r=n[0]?"login":"register",o,c,i,_,p;const P=[Qe,Ye],h=[];function k(u,N){return u[0]?0:1}return t=k(n),s=h[t]=P[t](n),{c(){s.c(),e=B(),l=w("button"),o=U(r),c=U(" instead"),this.h()},l(u){s.l(u),e=V(u),l=T(u,"BUTTON",{id:!0,class:!0});var N=j(l);o=H(N,r),c=H(N," instead"),N.forEach(a),this.h()},h(){J(l,"id","flip"),J(l,"class","svelte-1ykj3bu")},m(u,N){h[t].m(u,N),E(u,e,N),E(u,l,N),g(l,o),g(l,c),i=!0,_||(p=G(l,"click",n[3]),_=!0)},p(u,N){let m=t;t=k(u),t===m?h[t].p(u,N):(le(),M(h[m],1,1,()=>{h[m]=null}),se(),s=h[t],s?s.p(u,N):(s=h[t]=P[t](u),s.c()),z(s,1),s.m(e.parentNode,e)),(!i||N&1)&&r!==(r=u[0]?"login":"register")&&K(o,r)},i(u){i||(z(s),i=!0)},o(u){M(s),i=!1},d(u){h[t].d(u),u&&a(e),u&&a(l),_=!1,p()}}}function Fe(n){let t,s;return t=new Me({props:{user:n[1]}}),{c(){X(t.$$.fragment)},l(e){Z(t.$$.fragment,e)},m(e,l){$(t,e,l),s=!0},p(e,l){const r={};l&2&&(r.user=e[1]),t.$set(r)},i(e){s||(z(t.$$.fragment,e),s=!0)},o(e){M(t.$$.fragment,e),s=!1},d(e){x(t,e)}}}function Ye(n){let t,s;return t=new We({props:{user:n[1],succ:n[2]}}),{c(){X(t.$$.fragment)},l(e){Z(t.$$.fragment,e)},m(e,l){$(t,e,l),s=!0},p(e,l){const r={};l&2&&(r.user=e[1]),t.$set(r)},i(e){s||(z(t.$$.fragment,e),s=!0)},o(e){M(t.$$.fragment,e),s=!1},d(e){x(t,e)}}}function Qe(n){let t,s;return t=new Pe({props:{user:n[1],succ:n[2]}}),{c(){X(t.$$.fragment)},l(e){Z(t.$$.fragment,e)},m(e,l){$(t,e,l),s=!0},p(e,l){const r={};l&2&&(r.user=e[1]),t.$set(r)},i(e){s||(z(t.$$.fragment,e),s=!0)},o(e){M(t.$$.fragment,e),s=!1},d(e){x(t,e)}}}function Xe(n){let t,s,e,l;const r=[Fe,Ce],o=[];function c(i,_){return i[1].loggedIn==!0?0:1}return s=c(n),e=o[s]=r[s](n),{c(){t=w("div"),e.c(),this.h()},l(i){t=T(i,"DIV",{class:!0});var _=j(t);e.l(_),_.forEach(a),this.h()},h(){J(t,"class","welcome svelte-1ykj3bu")},m(i,_){E(i,t,_),o[s].m(t,null),l=!0},p(i,[_]){let p=s;s=c(i),s===p?o[s].p(i,_):(le(),M(o[p],1,1,()=>{o[p]=null}),se(),e=o[s],e?e.p(i,_):(e=o[s]=r[s](i),e.c()),z(e,1),e.m(t,null))},i(i){l||(z(e),l=!0)},o(i){M(e),l=!1},d(i){i&&a(t),o[s].d()}}}function Ze(n,t,s){let e=!0,l={name:A.get_local("user_name"),passhash:A.get_local("pass_hash")};l.loggedIn=l.name!=null;function r(){s(1,l.loggedIn=!0,l)}return[e,l,r,()=>{s(0,e=!e)}]}class $e extends W{constructor(t){super(),C(this,t,Ze,Xe,F,{})}}function xe(n){let t,s,e;return s=new $e({}),{c(){t=w("body"),X(s.$$.fragment),this.h()},l(l){t=T(l,"BODY",{class:!0});var r=j(t);Z(s.$$.fragment,r),r.forEach(a),this.h()},h(){J(t,"class","svelte-qgsnnm")},m(l,r){E(l,t,r),$(s,t,null),e=!0},p:q,i(l){e||(z(s.$$.fragment,l),e=!0)},o(l){M(s.$$.fragment,l),e=!1},d(l){l&&a(t),x(s)}}}class lt extends W{constructor(t){super(),C(this,t,null,xe,F,{})}}export{lt as default};
