import{S as C,i as F,s as Y,k as y,q as H,a as q,l as T,m as S,r as B,h as u,c as V,n as J,b as w,F as g,H as W,I as M,A,J as Ee,p as we,u as R,K as se,L as X,e as le,g as ne,t as z,d as oe,f as Q,v as Z,w as $,x,y as ee}from"../../chunks/index-549be724.js";import{u as K}from"../../chunks/utils-c14c6f14.js";function re(n){let t,s;return{c(){t=y("p"),s=H(n[1]),this.h()},l(e){t=T(e,"P",{style:!0});var l=S(t);s=B(l,n[1]),l.forEach(u),this.h()},h(){we(t,"color","red")},m(e,l){w(e,t,l),g(t,s)},p(e,l){l&2&&R(s,e[1])},d(e){e&&u(t)}}}function ye(n){let t,s,e,l,r,o,c,a,h,m,N,_,k,f,P,p,I,U,b,d,E,O,L=n[1]&&re(n);return{c(){t=y("h1"),s=H("create account"),e=q(),l=y("h2"),r=H(`username
`),o=y("input"),c=q(),a=y("p"),h=H(`

password
`),m=y("input"),N=q(),_=y("p"),k=H(`

email
`),f=y("input"),P=q(),L&&L.c(),p=q(),I=y("p"),U=q(),b=y("button"),d=H("join"),this.h()},l(i){t=T(i,"H1",{});var v=S(t);s=B(v,"create account"),v.forEach(u),e=V(i),l=T(i,"H2",{});var j=S(l);r=B(j,`username
`),o=T(j,"INPUT",{type:!0}),c=V(j),a=T(j,"P",{}),S(a).forEach(u),h=B(j,`

password
`),m=T(j,"INPUT",{type:!0}),N=V(j),_=T(j,"P",{}),S(_).forEach(u),k=B(j,`

email
`),f=T(j,"INPUT",{}),P=V(j),L&&L.l(j),p=V(j),I=T(j,"P",{}),S(I).forEach(u),U=V(j),b=T(j,"BUTTON",{});var D=S(b);d=B(D,"join"),D.forEach(u),j.forEach(u),this.h()},h(){J(o,"type","text"),J(m,"type","password")},m(i,v){w(i,t,v),g(t,s),w(i,e,v),w(i,l,v),g(l,r),g(l,o),W(o,n[0].name),g(l,c),g(l,a),g(l,h),g(l,m),W(m,n[0].password),g(l,N),g(l,_),g(l,k),g(l,f),W(f,n[0].email),g(l,P),L&&L.m(l,null),g(l,p),g(l,I),g(l,U),g(l,b),g(b,d),E||(O=[M(o,"input",n[4]),M(m,"input",n[5]),M(f,"input",n[6]),M(b,"click",n[2])],E=!0)},p(i,[v]){v&1&&o.value!==i[0].name&&W(o,i[0].name),v&1&&m.value!==i[0].password&&W(m,i[0].password),v&1&&f.value!==i[0].email&&W(f,i[0].email),i[1]?L?L.p(i,v):(L=re(i),L.c(),L.m(l,p)):L&&(L.d(1),L=null)},i:A,o:A,d(i){i&&u(t),i&&u(e),i&&u(l),L&&L.d(),E=!1,Ee(O)}}}function Te(n,t,s){let{user:e}=t,{succ:l}=t,r="";function o(){if(e.name&&e.password){if(s(0,e.passhash=K.hash(e.password),e),e.email==""){s(1,r="email cant be empty");return}if(e.password==""){s(1,r="password cant be empty");return}if(e.name==""){s(1,r="username cant be empty");return}K.set_local("user_name",e.name),K.set_local("pass_hash",e.passhash),K.set_local("email",e.email),fetch(K.url+`register/${e.name}/${e.email}/${e.passhash}`,{method:"get"}).then(m=>{console.log(m),m.text().then(N=>{console.log({response:N});let _=JSON.parse(N);console.log(_),_[0]?(s(0,e.loggedIn=!0,e),l()):s(1,r=`${_.details}`)})})}else s(1,r="cant be empty")}function c(){e.name=this.value,s(0,e)}function a(){e.password=this.value,s(0,e)}function h(){e.email=this.value,s(0,e)}return n.$$set=m=>{"user"in m&&s(0,e=m.user),"succ"in m&&s(3,l=m.succ)},[e,r,o,l,c,a,h]}class Pe extends C{constructor(t){super(),F(this,t,Te,ye,Y,{user:0,succ:3})}}function ie(n,t,s){const e=n.slice();return e[23]=t[s],e[25]=s,e}function ae(n,t,s){const e=n.slice();return e[23]=t[s],e[27]=s,e}function ue(n,t,s){const e=n.slice();return e[23]=t[s],e[29]=s,e}function Ne(n){let t,s=n[1].reduce(n[12])[0]+"",e,l,r,o;return{c(){t=y("h2"),e=H(s),l=H(" found the treasure! get his King to win"),r=q(),o=y("p")},l(c){t=T(c,"H2",{});var a=S(t);e=B(a,s),l=B(a," found the treasure! get his King to win"),a.forEach(u),r=V(c),o=T(c,"P",{}),S(o).forEach(u)},m(c,a){w(c,t,a),g(t,e),g(t,l),w(c,r,a),w(c,o,a)},p(c,a){a&3&&s!==(s=c[1].reduce(c[12])[0]+"")&&R(e,s)},d(c){c&&u(t),c&&u(r),c&&u(o)}}}function je(n){let t,s;return{c(){t=y("h2"),s=H("get the treasure at the center!")},l(e){t=T(e,"H2",{});var l=S(t);s=B(l,"get the treasure at the center!"),l.forEach(u)},m(e,l){w(e,t,l),g(t,s)},p:A,d(e){e&&u(t)}}}function Ie(n){let t,s,e,l,r,o,c;return{c(){t=y("h2"),s=H("you got the treasure"),e=q(),l=y("h2"),r=H("go to the green zone to win!"),o=q(),c=y("p")},l(a){t=T(a,"H2",{});var h=S(t);s=B(h,"you got the treasure"),h.forEach(u),e=V(a),l=T(a,"H2",{});var m=S(l);r=B(m,"go to the green zone to win!"),m.forEach(u),o=V(a),c=T(a,"P",{}),S(c).forEach(u)},m(a,h){w(a,t,h),g(t,s),w(a,e,h),w(a,l,h),g(l,r),w(a,o,h),w(a,c,h)},p:A,d(a){a&&u(t),a&&u(e),a&&u(l),a&&u(o),a&&u(c)}}}function fe(n){let t,s,e,l=n[8](n[0].data[n[27]+n[29]*9])+"",r,o,c,a,h;function m(){return n[13](n[27],n[29])}return{c(){t=y("div"),s=y("div"),e=y("p"),r=H(l),this.h()},l(N){t=T(N,"DIV",{class:!0,id:!0});var _=S(t);s=T(_,"DIV",{class:!0});var k=S(s);e=T(k,"P",{class:!0});var f=S(e);r=B(f,l),f.forEach(u),k.forEach(u),_.forEach(u),this.h()},h(){J(e,"class","pinfo svelte-xd1drb"),J(s,"class",o=X(n[6](n[0].data[n[27]+n[29]*9]))+" svelte-xd1drb"),J(t,"class",c=X((n[27]==n[2][0]&&n[29]==n[2][1]?"active ":"")+de(n[0].data[n[27]+n[29]*9],n[0].offset[0]+n[0].offset[1]+n[27]+n[29]))+" svelte-xd1drb"),J(t,"id","t"+n[27]+n[29])},m(N,_){w(N,t,_),g(t,s),g(s,e),g(e,r),a||(h=M(t,"click",m),a=!0)},p(N,_){n=N,_&1&&l!==(l=n[8](n[0].data[n[27]+n[29]*9])+"")&&R(r,l),_&1&&o!==(o=X(n[6](n[0].data[n[27]+n[29]*9]))+" svelte-xd1drb")&&J(s,"class",o),_&5&&c!==(c=X((n[27]==n[2][0]&&n[29]==n[2][1]?"active ":"")+de(n[0].data[n[27]+n[29]*9],n[0].offset[0]+n[0].offset[1]+n[27]+n[29]))+" svelte-xd1drb")&&J(t,"class",c)},d(N){N&&u(t),a=!1,h()}}}function ce(n){let t,s={length:9},e=[];for(let l=0;l<s.length;l+=1)e[l]=fe(ue(n,s,l));return{c(){t=y("div");for(let l=0;l<e.length;l+=1)e[l].c();this.h()},l(l){t=T(l,"DIV",{class:!0});var r=S(t);for(let o=0;o<e.length;o+=1)e[o].l(r);r.forEach(u),this.h()},h(){J(t,"class","row svelte-xd1drb")},m(l,r){w(l,t,r);for(let o=0;o<e.length;o+=1)e[o].m(t,null)},p(l,r){if(r&357){s={length:9};let o;for(o=0;o<s.length;o+=1){const c=ue(l,s,o);e[o]?e[o].p(c,r):(e[o]=fe(c),e[o].c(),e[o].m(t,null))}for(;o<e.length;o+=1)e[o].d(1);e.length=s.length}},d(l){l&&u(t),se(e,l)}}}function Se(n){let t,s;return{c(){t=y("div"),s=H("no"),this.h()},l(e){t=T(e,"DIV",{class:!0});var l=S(t);s=B(l,"no"),l.forEach(u),this.h()},h(){J(t,"class","tile svelte-xd1drb")},m(e,l){w(e,t,l),g(t,s)},p:A,d(e){e&&u(t)}}}function Oe(n){let t,s={length:5},e=[];for(let l=0;l<s.length;l+=1)e[l]=he(ie(n,s,l));return{c(){t=y("div");for(let l=0;l<e.length;l+=1)e[l].c();this.h()},l(l){t=T(l,"DIV",{class:!0});var r=S(t);for(let o=0;o<e.length;o+=1)e[o].l(r);r.forEach(u),this.h()},h(){J(t,"class","row svelte-xd1drb")},m(l,r){w(l,t,r);for(let o=0;o<e.length;o+=1)e[o].m(t,null)},p(l,r){if(r&145){s={length:5};let o;for(o=0;o<s.length;o+=1){const c=ie(l,s,o);e[o]?e[o].p(c,r):(e[o]=he(c),e[o].c(),e[o].m(t,null))}for(;o<e.length;o+=1)e[o].d(1);e.length=s.length}},d(l){l&&u(t),se(e,l)}}}function _e(n){let t,s,e,l,r;function o(){return n[14](n[25])}return{c(){t=y("div"),s=y("div"),e=q(),this.h()},l(c){t=T(c,"DIV",{class:!0});var a=S(t);s=T(a,"DIV",{class:!0});var h=S(s);h.forEach(u),e=V(a),a.forEach(u),this.h()},h(){J(s,"class",X(`piece t${n[25]+2}`)+" svelte-xd1drb"),J(t,"class","tile svelte-xd1drb")},m(c,a){w(c,t,a),g(t,s),g(t,e),l||(r=M(t,"click",o),l=!0)},p(c,a){n=c},d(c){c&&u(t),l=!1,r()}}}function he(n){let t,s=n[4][n[25]]<=n[0].energy&&_e(n);return{c(){s&&s.c(),t=le()},l(e){s&&s.l(e),t=le()},m(e,l){s&&s.m(e,l),w(e,t,l)},p(e,l){e[4][e[25]]<=e[0].energy?s?s.p(e,l):(s=_e(e),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},d(e){s&&s.d(e),e&&u(t)}}}function Ue(n){let t,s,e,l,r,o,c,a,h=Math.round(n[0].energy*50)/50+"",m,N;function _(d,E){return d[0].got_treasure?Ie:d[0].treasure_holder==-1?je:Ne}let k=_(n),f=k(n),P={length:9},p=[];for(let d=0;d<P.length;d+=1)p[d]=ce(ae(n,P,d));function I(d,E){return d[3]?Oe:Se}let U=I(n),b=U(n);return{c(){t=y("div"),f.c(),s=q();for(let d=0;d<p.length;d+=1)p[d].c();e=q(),l=y("p"),r=q(),b.c(),o=q(),c=y("div"),a=y("p"),m=H(h),this.h()},l(d){t=T(d,"DIV",{class:!0});var E=S(t);f.l(E),s=V(E);for(let i=0;i<p.length;i+=1)p[i].l(E);e=V(E),l=T(E,"P",{}),S(l).forEach(u),r=V(E),b.l(E),o=V(E),c=T(E,"DIV",{class:!0,style:!0});var O=S(c);a=T(O,"P",{class:!0});var L=S(a);m=B(L,h),L.forEach(u),O.forEach(u),E.forEach(u),this.h()},h(){J(a,"class","svelte-xd1drb"),J(c,"class","energybar svelte-xd1drb"),J(c,"style",N=`width:${n[0].energy*2.7}em`),J(t,"class","board svelte-xd1drb")},m(d,E){w(d,t,E),f.m(t,null),g(t,s);for(let O=0;O<p.length;O+=1)p[O].m(t,null);g(t,e),g(t,l),g(t,r),b.m(t,null),g(t,o),g(t,c),g(c,a),g(a,m)},p(d,[E]){if(k===(k=_(d))&&f?f.p(d,E):(f.d(1),f=k(d),f&&(f.c(),f.m(t,s))),E&357){P={length:9};let O;for(O=0;O<P.length;O+=1){const L=ae(d,P,O);p[O]?p[O].p(L,E):(p[O]=ce(L),p[O].c(),p[O].m(t,e))}for(;O<p.length;O+=1)p[O].d(1);p.length=P.length}U===(U=I(d))&&b?b.p(d,E):(b.d(1),b=U(d),b&&(b.c(),b.m(t,o))),E&1&&h!==(h=Math.round(d[0].energy*50)/50+"")&&R(m,h),E&1&&N!==(N=`width:${d[0].energy*2.7}em`)&&J(c,"style",N)},i:A,o:A,d(d){d&&u(t),f.d(),se(p,d),b.d()}}}let me=20,He=.2;function pe(n,t){return n+t*9}function de(n,t){if(n==null)return"water tile";if(n.status.Taken)return"tile c"+n.status.Taken[0];let s="";return n.ground=="Safe"&&(s=" safe"),n.ground=="Treasure"&&(s=" treasure"),["light","dark"][t%2]+s+" tile"}function Be(n,t,s){let{state:e}=t,{my_number:l}=t,{make_move:r}=t,{opponents:o}=t;e.data;let c=[4,4];const a=[9,3,3,5,1];let h=[-5,-5],m=[],N=!1,_=1;setInterval(()=>{e.energy<=10&&s(0,e.energy=Math.min(e.energy+He/me,10),e)},1e3/me);function k(i,v){console.log("clcik");let j=e.data[i+v*9];j&&j.status&&j.status.Taken&&j.status.Taken[1]=="King"&&j.status.Taken[0]==l?s(3,N=!0):(console.log(j),s(3,N=!1));let D=pe(h[0],h[1]),G=pe(i,v);G!=D&&(r(D,G,_,te=>{te&&(_=0)}),f(i,v),P(i,v))}function f(i,v){let j=document.querySelector("#t"+h[0]+h[1]);j&&j.classList.remove("active"),s(2,h=[i,v]),document.querySelector("#t"+i+v).classList.add("active")}function P(i,v){m.forEach(D=>{document.querySelector(D).classList.remove("target")});let j=document.querySelector("#t"+i+v).children[0].classList;m=[],j.contains("piece")?(console.log(_),_==2?j="Queen":_==3?j="Bishop":_==4?j="Knight":_==5?j="Rook":_==6?j="Pawn":j=j[1]):console.log(j),j=="Pawn"?m=["#t"+i+(v+1),"#t"+i+(v-1),"#t"+(i+1)+v,"#t"+(i-1)+v]:j=="Knight"?(I(i+1,v-2),I(i-1,v-2),I(i+1,v+2),I(i-1,v+2),I(i+2,v+1),I(i-2,v+1),I(i-2,v-1),I(i+2,v-1)):j=="Bishop"?p(i,v,[[1,1],[1,-1],[-1,1],[-1,-1]]):j=="Rook"?p(i,v,[[1,0],[0,-1],[-1,0],[0,1]]):j=="Queen"?p(i,v,[[1,0],[0,-1],[-1,0],[0,1],[1,1],[1,-1],[-1,1],[-1,-1]]):j=="King"&&(I(i+1,v+1),I(i-1,v+1),I(i-1,v-1),I(i+1,v-1),I(i+1,v+0),I(i-0,v+1),I(i-1,v-0),I(i+0,v-1)),m.forEach(D=>{document.querySelector(D).classList.add("target")})}function p(i,v,j){j.forEach(D=>{let G=[i,v];for(;G=[G[0]+D[0],G[1]+D[1]],!!I(G[0],G[1]););})}function I(i,v){if(i<0||i>8||v<0||v>8)return!1;let j="#t"+i+v,D=document.querySelector(j).children[0].classList;return D.contains("piece")?(D.contains("enemy")&&m.push(j),!1):(m.push(j),!0)}function U(i){if(i==null||i.status=="Empty")return"";if(i.status.Taken){let v=i.status.Taken,j=v[0],D=v[1],G=j==l;return D=="King"&&G&&_>1?"piece t"+_:"piece "+D+(G?"":" enemy")}return"piece error"}function b(i){_=i+2,P(h[0],h[1])}function d(i){if(i&&i.status&&i.status.Taken&&i.status.Taken[1]=="King"){let v=i.status.Taken[0],j=o.reduce((D,G)=>D[1]==v?D:G)[0];return j=j.split(" ")[0],j.slice(0,8)}return""}const E=(i,v)=>i[1]==e.treasure_holder?i:v,O=(i,v)=>k(i,v),L=i=>{b(i)};return n.$$set=i=>{"state"in i&&s(0,e=i.state),"my_number"in i&&s(9,l=i.my_number),"make_move"in i&&s(10,r=i.make_move),"opponents"in i&&s(1,o=i.opponents)},n.$$.update=()=>{n.$$.dirty&2053&&e.offset!=c&&(s(2,h=[h[0]+c[1]-e.offset[1],h[1]+c[0]-e.offset[0]]),s(11,c=e.offset))},[e,o,h,N,a,k,U,b,d,l,r,c,E,O,L]}class Je extends C{constructor(t){super(),F(this,t,Be,Ue,Y,{state:0,my_number:9,make_move:10,opponents:1})}}function be(n,t,s){const e=n.slice();return e[18]=t[s][0],e[19]=t[s][1],e}function Le(n){let t,s,e,l,r,o,c=n[7].Leave.value+"",a,h,m,N,_,k,f,P,p,I;return{c(){t=y("h3"),s=H("you left"),e=q(),l=y("h3"),r=H("score: "),o=y("span"),a=H(c),h=q(),m=y("button"),N=H("Play again"),_=q(),k=y("a"),f=y("button"),P=H("leaderboard"),this.h()},l(U){t=T(U,"H3",{});var b=S(t);s=B(b,"you left"),b.forEach(u),e=V(U),l=T(U,"H3",{});var d=S(l);r=B(d,"score: "),o=T(d,"SPAN",{class:!0});var E=S(o);a=B(E,c),E.forEach(u),d.forEach(u),h=V(U),m=T(U,"BUTTON",{id:!0});var O=S(m);N=B(O,"Play again"),O.forEach(u),_=V(U),k=T(U,"A",{href:!0});var L=S(k);f=T(L,"BUTTON",{class:!0});var i=S(f);P=B(i,"leaderboard"),i.forEach(u),L.forEach(u),this.h()},h(){J(o,"class","gold svelte-jcaibo"),J(m,"id","joingame"),J(f,"class","leaderboard svelte-jcaibo"),J(k,"href","/leaderboard")},m(U,b){w(U,t,b),g(t,s),w(U,e,b),w(U,l,b),g(l,r),g(l,o),g(o,a),w(U,h,b),w(U,m,b),g(m,N),w(U,_,b),w(U,k,b),g(k,f),g(f,P),p||(I=M(m,"click",n[8]),p=!0)},p(U,b){b&128&&c!==(c=U[7].Leave.value+"")&&R(a,c)},i:A,o:A,d(U){U&&u(t),U&&u(e),U&&u(l),U&&u(h),U&&u(m),U&&u(_),U&&u(k),p=!1,I()}}}function qe(n){let t,s,e,l,r=n[6][0]+"",o,c,a=n[5].value+"",h,m,N,_,k,f,P,p,I,U,b,d,E,O,L;return{c(){t=y("h2"),s=H("GAME OVER"),e=q(),l=y("h3"),o=H(r),c=H(" won "),h=H(a),m=H(" points!"),N=q(),_=y("p"),k=q(),f=y("button"),P=H("Play again"),p=q(),I=y("p"),U=q(),b=y("a"),d=y("button"),E=H("leaderboard"),this.h()},l(i){t=T(i,"H2",{});var v=S(t);s=B(v,"GAME OVER"),v.forEach(u),e=V(i),l=T(i,"H3",{});var j=S(l);o=B(j,r),c=B(j," won "),h=B(j,a),m=B(j," points!"),j.forEach(u),N=V(i),_=T(i,"P",{}),S(_).forEach(u),k=V(i),f=T(i,"BUTTON",{class:!0});var D=S(f);P=B(D,"Play again"),D.forEach(u),p=V(i),I=T(i,"P",{}),S(I).forEach(u),U=V(i),b=T(i,"A",{href:!0});var G=S(b);d=T(G,"BUTTON",{class:!0});var te=S(d);E=B(te,"leaderboard"),te.forEach(u),G.forEach(u),this.h()},h(){J(f,"class","joingame svelte-jcaibo"),J(d,"class","leaderboard svelte-jcaibo"),J(b,"href","/leaderboard")},m(i,v){w(i,t,v),g(t,s),w(i,e,v),w(i,l,v),g(l,o),g(l,c),g(l,h),g(l,m),w(i,N,v),w(i,_,v),w(i,k,v),w(i,f,v),g(f,P),w(i,p,v),w(i,I,v),w(i,U,v),w(i,b,v),g(b,d),g(d,E),O||(L=M(f,"click",n[8]),O=!0)},p(i,v){v&64&&r!==(r=i[6][0]+"")&&R(o,r),v&32&&a!==(a=i[5].value+"")&&R(h,a)},i:A,o:A,d(i){i&&u(t),i&&u(e),i&&u(l),i&&u(N),i&&u(_),i&&u(k),i&&u(f),i&&u(p),i&&u(I),i&&u(U),i&&u(b),O=!1,L()}}}function Ve(n){let t,s,e,l,r,o,c;return l=new Je({props:{state:n[4],my_number:n[2],make_move:n[10],opponents:n[3]}}),{c(){t=y("button"),s=H("leave game"),e=q(),Z(l.$$.fragment),this.h()},l(a){t=T(a,"BUTTON",{class:!0});var h=S(t);s=B(h,"leave game"),h.forEach(u),e=V(a),$(l.$$.fragment,a),this.h()},h(){J(t,"class","surrender svelte-jcaibo")},m(a,h){w(a,t,h),g(t,s),w(a,e,h),x(l,a,h),r=!0,o||(c=M(t,"click",n[12]),o=!0)},p(a,h){const m={};h&16&&(m.state=a[4]),h&4&&(m.my_number=a[2]),h&8&&(m.opponents=a[3]),l.$set(m)},i(a){r||(Q(l.$$.fragment,a),r=!0)},o(a){z(l.$$.fragment,a),r=!1},d(a){a&&u(t),a&&u(e),ee(l,a),o=!1,c()}}}function De(n){let t,s,e,l,r,o,c,a,h,m,N=n[3],_=[];for(let f=0;f<N.length;f+=1)_[f]=ge(be(n,N,f));let k=n[3].length>1&&ve(n);return{c(){t=y("h2"),s=H("waiting for players ..."),e=q();for(let f=0;f<_.length;f+=1)_[f].c();l=q(),r=y("button"),o=H("leave"),c=q(),k&&k.c(),a=le(),this.h()},l(f){t=T(f,"H2",{});var P=S(t);s=B(P,"waiting for players ..."),P.forEach(u),e=V(f);for(let I=0;I<_.length;I+=1)_[I].l(f);l=V(f),r=T(f,"BUTTON",{class:!0});var p=S(r);o=B(p,"leave"),p.forEach(u),c=V(f),k&&k.l(f),a=le(),this.h()},h(){J(r,"class","leaderboard svelte-jcaibo")},m(f,P){w(f,t,P),g(t,s),w(f,e,P);for(let p=0;p<_.length;p+=1)_[p].m(f,P);w(f,l,P),w(f,r,P),g(r,o),w(f,c,P),k&&k.m(f,P),w(f,a,P),h||(m=M(r,"click",n[11]),h=!0)},p(f,P){if(P&8){N=f[3];let p;for(p=0;p<N.length;p+=1){const I=be(f,N,p);_[p]?_[p].p(I,P):(_[p]=ge(I),_[p].c(),_[p].m(l.parentNode,l))}for(;p<_.length;p+=1)_[p].d(1);_.length=N.length}f[3].length>1?k?k.p(f,P):(k=ve(f),k.c(),k.m(a.parentNode,a)):k&&(k.d(1),k=null)},i:A,o:A,d(f){f&&u(t),f&&u(e),se(_,f),f&&u(l),f&&u(r),f&&u(c),k&&k.d(f),f&&u(a),h=!1,m()}}}function Ae(n){let t,s,e,l,r,o,c,a,h,m,N,_,k,f,P;return{c(){t=y("div"),s=q(),e=y("h2"),l=H("Welcome to Tarcarot"),r=q(),o=y("button"),c=H("Join game"),a=q(),h=y("p"),m=q(),N=y("a"),_=y("button"),k=H("leaderboard"),this.h()},l(p){t=T(p,"DIV",{class:!0}),S(t).forEach(u),s=V(p),e=T(p,"H2",{class:!0});var I=S(e);l=B(I,"Welcome to Tarcarot"),I.forEach(u),r=V(p),o=T(p,"BUTTON",{class:!0});var U=S(o);c=B(U,"Join game"),U.forEach(u),a=V(p),h=T(p,"P",{}),S(h).forEach(u),m=V(p),N=T(p,"A",{href:!0});var b=S(N);_=T(b,"BUTTON",{class:!0});var d=S(_);k=B(d,"leaderboard"),d.forEach(u),b.forEach(u),this.h()},h(){J(t,"class","logo svelte-jcaibo"),J(e,"class","gold svelte-jcaibo"),J(o,"class","joingame svelte-jcaibo"),J(_,"class","leaderboard svelte-jcaibo"),J(N,"href","/leaderboard")},m(p,I){w(p,t,I),w(p,s,I),w(p,e,I),g(e,l),w(p,r,I),w(p,o,I),g(o,c),w(p,a,I),w(p,h,I),w(p,m,I),w(p,N,I),g(N,_),g(_,k),f||(P=M(o,"click",n[8]),f=!0)},p:A,i:A,o:A,d(p){p&&u(t),p&&u(s),p&&u(e),p&&u(r),p&&u(o),p&&u(a),p&&u(h),p&&u(m),p&&u(N),f=!1,P()}}}function ge(n){let t,s=n[18]+"",e;return{c(){t=y("p"),e=H(s)},l(l){t=T(l,"P",{});var r=S(t);e=B(r,s),r.forEach(u)},m(l,r){w(l,t,r),g(t,e)},p(l,r){r&8&&s!==(s=l[18]+"")&&R(e,s)},d(l){l&&u(t)}}}function ve(n){let t,s,e,l;return{c(){t=y("button"),s=H("Start"),this.h()},l(r){t=T(r,"BUTTON",{class:!0});var o=S(t);s=B(o,"Start"),o.forEach(u),this.h()},h(){J(t,"class","startgame svelte-jcaibo")},m(r,o){w(r,t,o),g(t,s),e||(l=M(t,"click",n[9]),e=!0)},p:A,d(r){r&&u(t),e=!1,l()}}}function Ke(n){let t,s,e=n[0].name+"",l,r,o,c,a;const h=[Ae,De,Ve,qe,Le],m=[];function N(_,k){return _[1]==0?0:_[1]==1?1:_[1]==2?2:_[1]==3?3:_[1]==4?4:-1}return~(o=N(n))&&(c=m[o]=h[o](n)),{c(){t=y("h2"),s=y("p"),l=H(e),r=q(),c&&c.c(),this.h()},l(_){t=T(_,"H2",{});var k=S(t);s=T(k,"P",{class:!0});var f=S(s);l=B(f,e),f.forEach(u),r=V(k),c&&c.l(k),k.forEach(u),this.h()},h(){J(s,"class","usertag svelte-jcaibo")},m(_,k){w(_,t,k),g(t,s),g(s,l),g(t,r),~o&&m[o].m(t,null),a=!0},p(_,[k]){(!a||k&1)&&e!==(e=_[0].name+"")&&R(l,e);let f=o;o=N(_),o===f?~o&&m[o].p(_,k):(c&&(ne(),z(m[f],1,1,()=>{m[f]=null}),oe()),~o?(c=m[o],c?c.p(_,k):(c=m[o]=h[o](_),c.c()),Q(c,1),c.m(t,null)):c=null)},i(_){a||(Q(c),a=!0)},o(_){z(c),a=!1},d(_){_&&u(t),~o&&m[o].d()}}}function Ge(n,t,s){let{user:e}=t,l=0,r=0,o=0,c=0,a=[],h=null,m=null,N=null,_=null;function k(){fetch(K.url+`join_game/${e.name}/${e.passhash}`).then(b=>{console.log(b),b.text().then(d=>{console.log({text:d});let E=JSON.parse(d);console.log({data:E}),E.Join?(s(1,l=1),console.log("got join message"),r=E.Join.token,o=E.Join.game_id,s(2,c=E.Join.number),f()):E.Lobby?console.log("got lobby message"):E.State&&console.log("got state message")})})}function f(){console.log("sending update request"),fetch(K.url+`get_update/${o}/${r}`).then(b=>{console.log(b),b.text().then(d=>{console.log({text:d});let E=JSON.parse(d);if(console.log({data:E}),E.Join)console.log("got join message");else if(E.Lobby)console.log("got lobby message"),s(3,a=E.Lobby.players);else if(E.State)console.log("got state message"),s(4,h=E.State),s(1,l=2);else if(E.End){s(1,l=3),console.log("got game over message"),s(5,m=E.End),console.log(m),s(6,N=a.reduce((O,L)=>O[1]==m.winning_number?O:L));return}else if(E=="Leave"){console.log("got leave message"),alert("you disconnected from the game"),s(1,l=0);return}f()})})}function P(){console.log("sending start request"),fetch(K.url+`start_game/${o}/${r}`).then(b=>{console.log(b),b.text().then(d=>{console.log(d)})})}function p(b,d,E,O){console.log("sending move"),fetch(K.url+`make_move/${o}/${r}/${b}/${d}/${E}`,{method:"post"}).then(L=>{L.text().then(i=>{console.log(i);let v=JSON.parse(i);O(v)})})}function I(){console.log("leaving lobby"),fetch(K.url+`leave_lobby/${o}/${r}`).then(b=>{console.log(b),b.text().then(d=>{console.log(d)})}),s(1,l=0)}function U(){console.log("game leave request"),fetch(K.url+`leave_game/${o}/${r}`).then(b=>{console.log(b),b.text().then(d=>{console.log(d);let E=JSON.parse(d);if(E.End){s(1,l=3),console.log("got game over message"),s(5,m=E.End),console.log(m),s(6,N=a.reduce((O,L)=>O[1]==m.winning_number?O:L)),s(1,l=3);return}else s(7,_=E),s(1,l=4)})})}return n.$$set=b=>{"user"in b&&s(0,e=b.user)},[e,l,c,a,h,m,N,_,k,P,p,I,U]}class Me extends C{constructor(t){super(),F(this,t,Ge,Ke,Y,{user:0})}}function ke(n){let t,s;return{c(){t=y("p"),s=H(n[1]),this.h()},l(e){t=T(e,"P",{style:!0});var l=S(t);s=B(l,n[1]),l.forEach(u),this.h()},h(){we(t,"color","red")},m(e,l){w(e,t,l),g(t,s)},p(e,l){l&2&&R(s,e[1])},d(e){e&&u(t)}}}function Re(n){let t,s,e,l,r,o,c,a,h,m,N,_,k,f,P,p,I,U,b=n[1]&&ke(n);return{c(){t=y("h1"),s=H("login"),e=q(),l=y("h2"),r=H(`username
`),o=y("input"),c=q(),a=y("p"),h=H(`

password
`),m=y("input"),N=q(),b&&b.c(),_=q(),k=y("p"),f=q(),P=y("button"),p=H("login"),this.h()},l(d){t=T(d,"H1",{});var E=S(t);s=B(E,"login"),E.forEach(u),e=V(d),l=T(d,"H2",{});var O=S(l);r=B(O,`username
`),o=T(O,"INPUT",{type:!0}),c=V(O),a=T(O,"P",{}),S(a).forEach(u),h=B(O,`

password
`),m=T(O,"INPUT",{type:!0}),N=V(O),b&&b.l(O),_=V(O),k=T(O,"P",{}),S(k).forEach(u),f=V(O),P=T(O,"BUTTON",{});var L=S(P);p=B(L,"login"),L.forEach(u),O.forEach(u),this.h()},h(){J(o,"type","text"),J(m,"type","password")},m(d,E){w(d,t,E),g(t,s),w(d,e,E),w(d,l,E),g(l,r),g(l,o),W(o,n[0].name),g(l,c),g(l,a),g(l,h),g(l,m),W(m,n[0].password),g(l,N),b&&b.m(l,null),g(l,_),g(l,k),g(l,f),g(l,P),g(P,p),I||(U=[M(o,"input",n[4]),M(m,"input",n[5]),M(P,"click",n[2])],I=!0)},p(d,[E]){E&1&&o.value!==d[0].name&&W(o,d[0].name),E&1&&m.value!==d[0].password&&W(m,d[0].password),d[1]?b?b.p(d,E):(b=ke(d),b.c(),b.m(l,_)):b&&(b.d(1),b=null)},i:A,o:A,d(d){d&&u(t),d&&u(e),d&&u(l),b&&b.d(),I=!1,Ee(U)}}}function ze(n,t,s){let{user:e}=t,{succ:l}=t,r="";function o(){if(s(0,e.passhash=K.hash(e.password),e),e.password==""){s(1,r="password cant be empty");return}if(e.name==""){s(1,r="username cant be empty");return}K.set_local("user_name",e.name),K.set_local("pass_hash",e.passhash),fetch(K.url+`login/${e.name}/${e.passhash}`,{method:"get"}).then(h=>{console.log(h),console.log({res:h}),h.text().then(m=>{console.log({response:m}),m=="true"?l():s(1,r="password or username incorrect")})})}function c(){e.name=this.value,s(0,e)}function a(){e.password=this.value,s(0,e)}return n.$$set=h=>{"user"in h&&s(0,e=h.user),"succ"in h&&s(3,l=h.succ)},[e,r,o,l,c,a]}class Qe extends C{constructor(t){super(),F(this,t,ze,Re,Y,{user:0,succ:3})}}function We(n){let t,s,e,l,r=n[0]?"login":"register",o,c,a,h,m;const N=[Ye,Fe],_=[];function k(f,P){return f[0]?0:1}return t=k(n),s=_[t]=N[t](n),{c(){s.c(),e=q(),l=y("button"),o=H(r),c=H(" instead"),this.h()},l(f){s.l(f),e=V(f),l=T(f,"BUTTON",{id:!0,class:!0});var P=S(l);o=B(P,r),c=B(P," instead"),P.forEach(u),this.h()},h(){J(l,"id","flip"),J(l,"class","svelte-1ykj3bu")},m(f,P){_[t].m(f,P),w(f,e,P),w(f,l,P),g(l,o),g(l,c),a=!0,h||(m=M(l,"click",n[3]),h=!0)},p(f,P){let p=t;t=k(f),t===p?_[t].p(f,P):(ne(),z(_[p],1,1,()=>{_[p]=null}),oe(),s=_[t],s?s.p(f,P):(s=_[t]=N[t](f),s.c()),Q(s,1),s.m(e.parentNode,e)),(!a||P&1)&&r!==(r=f[0]?"login":"register")&&R(o,r)},i(f){a||(Q(s),a=!0)},o(f){z(s),a=!1},d(f){_[t].d(f),f&&u(e),f&&u(l),h=!1,m()}}}function Ce(n){let t,s;return t=new Me({props:{user:n[1]}}),{c(){Z(t.$$.fragment)},l(e){$(t.$$.fragment,e)},m(e,l){x(t,e,l),s=!0},p(e,l){const r={};l&2&&(r.user=e[1]),t.$set(r)},i(e){s||(Q(t.$$.fragment,e),s=!0)},o(e){z(t.$$.fragment,e),s=!1},d(e){ee(t,e)}}}function Fe(n){let t,s;return t=new Qe({props:{user:n[1],succ:n[2]}}),{c(){Z(t.$$.fragment)},l(e){$(t.$$.fragment,e)},m(e,l){x(t,e,l),s=!0},p(e,l){const r={};l&2&&(r.user=e[1]),t.$set(r)},i(e){s||(Q(t.$$.fragment,e),s=!0)},o(e){z(t.$$.fragment,e),s=!1},d(e){ee(t,e)}}}function Ye(n){let t,s;return t=new Pe({props:{user:n[1],succ:n[2]}}),{c(){Z(t.$$.fragment)},l(e){$(t.$$.fragment,e)},m(e,l){x(t,e,l),s=!0},p(e,l){const r={};l&2&&(r.user=e[1]),t.$set(r)},i(e){s||(Q(t.$$.fragment,e),s=!0)},o(e){z(t.$$.fragment,e),s=!1},d(e){ee(t,e)}}}function Xe(n){let t,s,e,l;const r=[Ce,We],o=[];function c(a,h){return a[1].loggedIn==!0?0:1}return s=c(n),e=o[s]=r[s](n),{c(){t=y("div"),e.c(),this.h()},l(a){t=T(a,"DIV",{class:!0});var h=S(t);e.l(h),h.forEach(u),this.h()},h(){J(t,"class","welcome svelte-1ykj3bu")},m(a,h){w(a,t,h),o[s].m(t,null),l=!0},p(a,[h]){let m=s;s=c(a),s===m?o[s].p(a,h):(ne(),z(o[m],1,1,()=>{o[m]=null}),oe(),e=o[s],e?e.p(a,h):(e=o[s]=r[s](a),e.c()),Q(e,1),e.m(t,null))},i(a){l||(Q(e),l=!0)},o(a){z(e),l=!1},d(a){a&&u(t),o[s].d()}}}function Ze(n,t,s){let e=!0,l={name:K.get_local("user_name"),passhash:K.get_local("pass_hash")};l.loggedIn=l.name!=null;function r(){s(1,l.loggedIn=!0,l)}return[e,l,r,()=>{s(0,e=!e)}]}class $e extends C{constructor(t){super(),F(this,t,Ze,Xe,Y,{})}}function xe(n){let t,s,e;return s=new $e({}),{c(){t=y("body"),Z(s.$$.fragment),this.h()},l(l){t=T(l,"BODY",{class:!0});var r=S(t);$(s.$$.fragment,r),r.forEach(u),this.h()},h(){J(t,"class","svelte-qgsnnm")},m(l,r){w(l,t,r),x(s,t,null),e=!0},p:A,i(l){e||(Q(s.$$.fragment,l),e=!0)},o(l){z(s.$$.fragment,l),e=!1},d(l){l&&u(t),ee(s)}}}class lt extends C{constructor(t){super(),F(this,t,null,xe,Y,{})}}export{lt as default};
